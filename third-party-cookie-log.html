<html>
    <body>
        <button id="request-storage-access">Request storage access</button>
        Log of storage events:
        <div id="ls-logs"></div>
        <script>
            const lsLogs = document.getElementById('ls-logs');

            window.addEventListener('storage', (e) => {
                console.log('storage event', e)
                lsLogs.innerHTML = lsLogs.innerHTML + `
                    <div>
                        <b>${e.key}</b>: ${e.newValue}
                    </div>
                `;
            });

            let storageHandles;
            const requestStorageAccessBtn = document.getElementById('request-storage-access');
            requestStorageAccessBtn.addEventListener('click', async () => {
                console.log("requestStorageAccessBtn clicked");
                storageHandles = await document.requestStorageAccess({ all: true });
            });
        </script>
    </body>
</html>